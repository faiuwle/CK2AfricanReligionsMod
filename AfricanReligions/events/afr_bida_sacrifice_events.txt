namespace = AFRREL

character_event = {
    id = AFRREL.040
    desc = EVTDESC_AFRREL040
    picture = GFX_evt_afr_snake
    
    is_triggered_only = yes
    
    immediate = {
        random_courtier = {
            limit = {
                is_female = yes
                is_adult = yes
                prisoner = no
                is_married = no
                NOT = { dynasty = ROOT }
            }
            preferred_limit = {
                trait = fair
                NOT = { age = 40 }
            }
            preferred_limit = {
                NOT = { age = 40 }
            }
            preferred_limit = {
                trait = fair
            }
            save_event_target_as = bida_sacrifice_courtier
        }
        random_courtier = {
            limit = {
                is_female = yes
                is_adult = yes
                prisoner = yes
                is_married = no
            }
            preferred_limit = {
                trait = fair
                NOT = { age = 40 }
            }
            preferred_limit = {
                NOT = { age = 40 }
            }
            preferred_limit = {
                trait = fair
            }
            save_event_target_as = bida_sacrifice_prisoner
        }
        random_child = {
            limit = {
                is_female = yes
                is_adult = yes
                is_married = no
                is_landed = no
                liege = { character = PREV }
            }
            preferred_limit = {
                is_heir = no
                is_betrothed = no
                trait = fair
                NOT = { age = 40 }
            }
            preferred_limit = {
                is_heir = no
                is_betrothed = no
                NOT = { age = 40 }
            }
            preferred_limit = {
                is_heir = no
                trait = fair
                NOT = { age = 40 }
            }
            preferred_limit = {
                is_heir = no
                NOT = { age = 40 }
            }
            preferred_limit = {
                is_heir = no
                trait = fair
            }
            preferred_limit = {
                is_heir = no
            }
            save_event_target_as = bida_sacrifice_daughter
        }
    }
    
    option = {
        name = EVTOPTA_AFRREL040
        
        custom_tooltip = {
            text = bida_sacrifice_peasant_tooltip
            random = {
                chance = 50
                character_event = { id = AFRREL.041 days = 11 }
            }
        }
        
        ai_chance = {
            factor = 20
        }
    }
    
    option = {
        name = EVTOPTB_AFRREL040
        
        trigger = { event_target:bida_sacrifice_courtier = { always = yes } }
        
        prestige = 20
        piety = 20
        custom_tooltip = {
            text = bida_sacrifice_courtier_tooltip
            random = {
                chance = 50
                character_event = { id = AFRREL.041 days = 11 }
            }
        }

        event_target:bida_sacrifice_courtier = {
            save_persistent_event_target = { name = bida_sacrifice scope = ROOT }
        }
        
        ai_chance = {
            factor = 1
        }
    }
    
    option = {
        name = EVTOPTC_AFRREL040
        
        trigger = { event_target:bida_sacrifice_daughter = { always = yes } }
        
        prestige = 60
        piety = 60
        add_trait = diligent
        custom_tooltip = {
            text = bida_sacrifice_daughter_tooltip
        }
        
        event_target:bida_sacrifice_daughter = {
            save_persistent_event_target = { name = bida_sacrifice scope = ROOT }
        }
        
        ai_chance = {
            factor = 0  # Don't want the AI sacrificing potential wives
        }
    }
    
    option = {
        name = EVTOPTD_AFRREL040
        
        trigger = { event_target:bida_sacrifice_prisoner = { always = yes } }
        
        custom_tooltip = {
            text = bida_sacrifice_prisoner_tooltip
        }
        
        event_target:bida_sacrifice_prisoner = {
            save_persistent_event_target = { name = bida_sacrifice scope = ROOT }
        }
        
        ai_chance = {
            factor = 1
        }
    }
    
    option = {
        name = EVTOPTE_AFRREL040
        
        trigger = {
            is_female = yes
            is_married = no
            is_adult = yes
            OR = {
                trait = lunatic
                trait = zealous
                trait = imbecile
                trait = slow
                trait = dull
            }
        }
        
        tooltip_info_custom = bida_self_sacrifice_tooltip_info
        
        custom_tooltip = {
            text = bida_self_sacrifice_tooltip
        }
        
        ROOT = {
            save_persistent_event_target = { name = bida_sacrifice scope = ROOT }
        }
        
        ai_chance = {
            factor = 0  # Don't want the AI sacrificing potential wives
        }
    }
}

character_event = {
    id = AFRREL.041
    desc = EVTDESC_AFRREL041
    # picture: crying woman?
    
    is_triggered_only = yes
    
    immediate = {
        if = {
            limit = { persistent_event_target:bida_sacrifice = { always = yes } }
            random_courtier = {
                limit = {
                    is_female = yes
                    is_adult = yes
                    prisoner = no
                    is_married = no
                    NOT = { dynasty = ROOT }
                    NOT = { persistent_event_target:bida_sacrifice = { character = PREV } }
                }
                preferred_limit = {
                    trait = fair
                    NOT = { age = 40 }
                }
                preferred_limit = {
                    NOT = { age = 40 }
                }
                preferred_limit = {
                    trait = fair
                }
                save_event_target_as = bida_sacrifice_replacement
            }
        }
    }
    
    option = {
        name = EVTOPTA_AFRREL041
        
        custom_tooltip = {
            text = bida_sacrifice_ends_early_tooltip
            
            character_event = { id = 72999 }
        }
        prestige = -30

        if = {
            limit = { persistent_event_target:bida_sacrifice = { always = yes } }
            if = {
                limit = { prefers_men_trigger = no } 
                persistent_event_target:bida_sacrifice = { add_lover = ROOT }
            }
            else = {
                persistent_event_target:bida_sacrifice = { add_friend = ROOT }
            }
        }
        else = {
            create_character = {
                culture = ROOT
                religion = ROOT
                female = yes
                random_traits = yes
                trait = fair
            }
            if = {
                limit = { prefers_men_trigger = no }
                new_character = { add_lover = ROOT }
            }
            else = {
                new_character = { add_friend = ROOT }
            }
        }
        
        clear_persistent_event_target = bida_sacrifice
    }
    
    option = {
        name = EVTOPTB_AFRREL041
        
        custom_tooltip = {
            text = bida_sacrifice_continues_tooltip
        }
    }
    
    option = {
        name = EVTOPTC_AFRREL041
        
        trigger = {
            OR = {
                NOT = { persistent_event_target:bida_sacrifice = { always = yes } }
                event_target:bida_sacrifice_replacement = { always = yes }
            }
            intrigue = 15
        }
        
        tooltip_info = intrigue
        
        if = {
            limit = { persistent_event_target:bida_sacrifice = { always = yes } }
            if = {
                limit = { prefers_men_trigger = no } 
                persistent_event_target:bida_sacrifice = { add_lover = ROOT }
            }
            else = {
                persistent_event_target:bida_sacrifice = { add_friend = ROOT }
            }
        }
        else = {
            create_character = {
                culture = ROOT
                religion = ROOT
                female = yes
                random_traits = yes
                trait = fair
            }
            if = {
                limit = { prefers_men_trigger = no }
                new_character = { add_lover = ROOT }
            }
            else = {
                new_character = { add_friend = ROOT }
            }
        }
        
        if = {
            limit = { persistent_event_target:bida_sacrifice = { always = yes } }
            custom_tooltip = {
                text = bida_sacrifice_replacement_courtier_tooltip
            }
        }
        else = {
            custom_tooltip = {
                text = bida_sacrifice_replacement_peasant_tooltip
            }
        }
        
        random = {
            chance = 50
            add_trait = deceitful
        }
        
        event_target:bida_sacrifice_replacement = {
            save_persistent_event_target = { name = bida_sacrifice scope = ROOT }
        }
    }
}
    
    